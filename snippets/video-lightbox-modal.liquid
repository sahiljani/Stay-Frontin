{% comment %}
  Video Lightbox Modal
  A TikTok/Instagram-style video lightbox for immersive video viewing
  
  Usage:
  {% render 'video-lightbox-modal', section_id: section.id %}
{% endcomment %}

<video-lightbox-modal id="VideoLightbox-{{ section_id | default: 'default' }}" class="video-lightbox-modal media-modal">
  <div class="video-lightbox__container" role="dialog" aria-label="Video lightbox" aria-modal="true" tabindex="-1">
    
    <!-- Close button -->
    <button 
      id="ModalClose-{{ section_id | default: 'default' }}" 
      type="button" 
      class="video-lightbox__close visible"
      aria-label="{{ 'accessibility.close' | t }}"
    >
      <svg viewBox="0 0 24 24" fill="currentColor">
        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
      </svg>
    </button>

    <!-- Video counter -->
    <div class="video-lightbox__counter visible">
      1 / 1
    </div>

    <!-- Video container -->
    <div class="video-lightbox__video-container">
      <!-- Video will be dynamically inserted here -->
      <div class="video-lightbox__loading" style="display: none;"></div>
    </div>

    <!-- Navigation arrows (desktop) -->
    <div class="video-lightbox__navigation">
      <button 
        type="button" 
        class="video-lightbox__nav video-lightbox__nav--prev"
        aria-label="Previous video"
      >
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
        </svg>
      </button>
      
      <button 
        type="button" 
        class="video-lightbox__nav video-lightbox__nav--next"
        aria-label="Next video"
      >
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
        </svg>
      </button>
    </div>

    <!-- Video controls -->
    <div class="video-lightbox__controls">
      <!-- Play/Pause -->
      <button 
        type="button" 
        class="video-lightbox__control-btn video-lightbox__play-pause"
        aria-label="Play/Pause"
      >
        <svg class="play-icon" viewBox="0 0 24 24" fill="currentColor">
          <path d="M8 5v14l11-7z"/>
        </svg>
        <svg class="pause-icon" viewBox="0 0 24 24" fill="currentColor" style="display: none;">
          <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
        </svg>
      </button>

      <!-- Mute/Unmute -->
      <button 
        type="button" 
        class="video-lightbox__control-btn video-lightbox__mute"
        aria-label="Mute/Unmute"
      >
        <svg class="volume-icon" viewBox="0 0 24 24" fill="currentColor">
          <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
        </svg>
        <svg class="mute-icon" viewBox="0 0 24 24" fill="currentColor" style="display: none;">
          <path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"/>
        </svg>
      </button>

      <!-- Fullscreen -->
      <button 
        type="button" 
        class="video-lightbox__control-btn video-lightbox__fullscreen"
        aria-label="Toggle fullscreen"
      >
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>
        </svg>
      </button>
    </div>

    <!-- Product information -->
    <div class="video-lightbox__product-info">
      <div class="video-lightbox__product-card">
        <img 
          src="" 
          alt="" 
          class="video-lightbox__product-image"
          style="display: none;"
        >
        <div class="video-lightbox__product-details">
          <h3 class="video-lightbox__product-title"></h3>
          <p class="video-lightbox__product-price"></p>
        </div>
        <a 
          href="#" 
          class="video-lightbox__shop-btn"
          style="display: none;"
        >
          {{ 'products.product.add_to_cart' | t }}
        </a>
      </div>
    </div>

  </div>
</video-lightbox-modal>

<style>
  {% comment %} Inline styles for critical rendering {% endcomment %}
  .video-lightbox-modal {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0, 0, 0, 0.95);
    z-index: 9999;
    display: none;
    opacity: 0;
    visibility: hidden;
  }

  .video-lightbox-modal[open] {
    display: flex;
    opacity: 1;
    visibility: visible;
  }
</style>